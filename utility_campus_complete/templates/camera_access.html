{% extends "base.html" %}

{% block title %}Camera Access - Seat Availability{% endblock %}

{% block content %}
<div class="main-container">
    <div class="row mb-4">
        <div class="col-md-12">
            <h1 class="display-6 fw-bold text-primary">
                <i class="fas fa-video me-3"></i>Camera Access - Seat Availability
            </h1>
            <p class="lead text-muted">Monitor real-time seat availability across campus locations.</p>
        </div>
    </div>

    <!-- Camera Feeds Grid -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-university me-2"></i>Library
                    </h5>
                </div>
                <div class="card-body">
                    <div class="camera-feed" id="library-feed">
                        <div class="camera-placeholder">
                            <i class="fas fa-video fa-3x text-muted"></i>
                            <p class="mt-3">Library Camera Feed</p>
                            <div class="seat-status mt-3">
                                <span class="badge bg-success">Available: 45/50</span>
                                <span class="badge bg-warning ms-2">Occupied: 5</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" onclick="refreshFeed('library')">
                            <i class="fas fa-sync-alt me-1"></i>Refresh
                        </button>
                        <button class="btn btn-info btn-sm ms-2" onclick="toggleFullscreen('library-feed')">
                            <i class="fas fa-expand me-1"></i>Fullscreen
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-utensils me-2"></i>Canteen
                    </h5>
                </div>
                <div class="card-body">
                    <div class="camera-feed" id="canteen-feed">
                        <div class="camera-placeholder">
                            <i class="fas fa-video fa-3x text-muted"></i>
                            <p class="mt-3">Canteen Camera Feed</p>
                            <div class="seat-status mt-3">
                                <span class="badge bg-success">Available: 30/40</span>
                                <span class="badge bg-warning ms-2">Occupied: 10</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" onclick="refreshFeed('canteen')">
                            <i class="fas fa-sync-alt me-1"></i>Refresh
                        </button>
                        <button class="btn btn-info btn-sm ms-2" onclick="toggleFullscreen('canteen-feed')">
                            <i class="fas fa-expand me-1"></i>Fullscreen
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-chalkboard-teacher me-2"></i>Computer Lab
                    </h5>
                </div>
                <div class="card-body">
                    <div class="camera-feed" id="lab-feed">
                        <div class="camera-placeholder">
                            <i class="fas fa-video fa-3x text-muted"></i>
                            <p class="mt-3">Computer Lab Camera Feed</p>
                            <div class="seat-status mt-3">
                                <span class="badge bg-success">Available: 15/25</span>
                                <span class="badge bg-warning ms-2">Occupied: 10</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" onclick="refreshFeed('lab')">
                            <i class="fas fa-sync-alt me-1"></i>Refresh
                        </button>
                        <button class="btn btn-info btn-sm ms-2" onclick="toggleFullscreen('lab-feed')">
                            <i class="fas fa-expand me-1"></i>Fullscreen
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-graduation-cap me-2"></i>Study Hall
                    </h5>
                </div>
                <div class="card-body">
                    <div class="camera-feed" id="study-feed">
                        <div class="camera-placeholder">
                            <i class="fas fa-video fa-3x text-muted"></i>
                            <p class="mt-3">Study Hall Camera Feed</p>
                            <div class="seat-status mt-3">
                                <span class="badge bg-success">Available: 20/30</span>
                                <span class="badge bg-warning ms-2">Occupied: 10</span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-primary btn-sm" onclick="refreshFeed('study')">
                            <i class="fas fa-sync-alt me-1"></i>Refresh
                        </button>
                        <button class="btn btn-info btn-sm ms-2" onclick="toggleFullscreen('study-feed')">
                            <i class="fas fa-expand me-1"></i>Fullscreen
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Real-time Status -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-chart-bar me-2"></i>Real-time Availability Status
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="status-card text-center">
                                <h4 class="text-success">Library</h4>
                                <p class="h2 text-success">90%</p>
                                <small class="text-muted">45/50 seats available</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="status-card text-center">
                                <h4 class="text-warning">Canteen</h4>
                                <p class="h2 text-warning">75%</p>
                                <small class="text-muted">30/40 seats available</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="status-card text-center">
                                <h4 class="text-info">Computer Lab</h4>
                                <p class="h2 text-info">60%</p>
                                <small class="text-muted">15/25 seats available</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="status-card text-center">
                                <h4 class="text-primary">Study Hall</h4>
                                <p class="h2 text-primary">67%</p>
                                <small class="text-muted">20/30 seats available</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.camera-feed {
    width: 100%;
    height: 300px;
    background: #f8f9fa;
    border: 2px dashed #dee2e6;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.camera-placeholder {
    text-align: center;
    color: #6c757d;
}

.seat-status {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.status-card {
    padding: 20px;
    border-radius: 8px;
    background: #f8f9fa;
    border: 1px solid #dee2e6;
}

.status-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}
</style>

<script>
function refreshFeed(location) {
    const feed = document.getElementById(location + '-feed');
    feed.innerHTML = '<div class="camera-placeholder"><i class="fas fa-spinner fa-spin fa-3x text-primary"></i><p class="mt-3">Refreshing...</p></div>';
    
    setTimeout(() => {
        const available = Math.floor(Math.random() * 50) + 20;
        const total = Math.floor(Math.random() * 30) + 40;
        const occupied = total - available;
        
        feed.innerHTML = `
            <div class="camera-placeholder">
                <i class="fas fa-video fa-3x text-success"></i>
                <p class="mt-3">${location.charAt(0).toUpperCase() + location.slice(1)} Camera Feed</p>
                <div class="seat-status mt-3">
                    <span class="badge bg-success">Available: ${available}/${total}</span>
                    <span class="badge bg-warning ms-2">Occupied: ${occupied}</span>
                </div>
            </div>
        `;
    }, 1000);
}

function toggleFullscreen(elementId) {
    const element = document.getElementById(elementId);
    if (element.requestFullscreen) {
        element.requestFullscreen();
    } else if (element.webkitRequestFullscreen) {
        element.webkitRequestFullscreen();
    } else if (element.msRequestFullscreen) {
        element.msRequestFullscreen();
    }
}

// Auto-refresh every 30 seconds
setInterval(() => {
    const feeds = ['library', 'canteen', 'lab', 'study'];
    feeds.forEach(feed => {
        refreshFeed(feed);
    });
}, 30000);
</script>
{% endblock %}